---
title: JavaScript运行机制：Event Loop
tags:
  - js
  - Event Loop
date: 2018-07-08 16:50:58
---


### Javascript是单线程
Javascript是单线程，与它的用途有关。它的主要用途是与用户互动，操作DOM。若同时有两个线程，一个在某DOM上添加内容，另一个删除了这个DOM，此时该以哪个线程为准？为了避免复杂性，Javascript从诞生就是单线程。

>tip：HTMl5提出Web Worker标准，允许Javascript脚本创建多个线程，但子线程完全受主线程控制，且不得操作DOM。所以这个标准并没有改变Javascript单线程的本质。

<!-- more -->

### 任务队列
Javascript是单线程就意味着，所有任务都需要排队，前一个任务结束，才会执行后一个任务。
所有任务可以分成两种，同步任务和一部任务。同步任务，在主线程上排队执行的任务，只有前一个任务执行完毕，才能执行后一个任务；异步任务，不进主进程而进入任务队列的任务，当任务队列通知主进程，某个异步任务可以执行了，该任务才会进入主进程执行。

### Javascript运行机制
Javascript运行机制就是一个主进程加上一个任务队列。
所有的同步任务都在主进程上执行，形成一个执行栈。主进程外还存在一个任务队列，异步任务有了运行结果，就在任务队列中放置一个事件。执行栈的所有同步任务执行完毕后，会读取任务队列，看看有里面有哪些事件，对应哪些异步任务，结束等待状态，进入执行栈，开始执行。主进程不断重复上面的过程。

### 参考文章
* [JavaScript 运行机制详解：再谈Event Loop](http://www.ruanyifeng.com/blog/2014/10/event-loop.html)
